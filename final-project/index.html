<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Meta Description fro SEO -->
    <meta name="description" content="Explore the Museum of the Watched">

    <!-- Open Graph for Social Sharing -->
    <meta property="og:title" content="Museum of the Watched">
    <meta property="og:description" content="CART-211 Final Project">

    <!-- Author and Copyright -->
    <meta name="author" content="Haolei Ma">
    <meta name="copyright" content="© Copyright Haolei Ma, student project, 2025">

    <title>Museum of the Watched - Entrance</title>

    <!-- External Stylesheet -->
    <link rel="stylesheet" href="default.css">

</head>

<body class="home">
    <div class="matrix-bg">
        <div class="matrix-layer" id="layer-back"></div>
        <div class="matrix-layer" id="layer-front"></div>
    </div>

    <div class="secret-msg" id="secretMsg"></div>

    <div class="scan-lines"></div>
    <div class="data-stream"></div>

    <main class="container">
        <header class="museum-header">
            <h1 class="museum-title">Museum of the Watched</h1>
        </header>

        <div class="consent-agreement">
            <div class="agreement-text">
                <p>Welcome to the Museum of the Watched</p>
                <p>By entering this museum, you consent to our collection and processing of your behavioral data for
                    artistic and analytical purposes.</p>
                <p>Every click, dwell time, scroll action, and interactive choice you make will become part of the
                    exhibit.
                </p>
                <p class="small-text">* This consent is irrevocable. Closing this page constitutes your agreement.</p>
            </div>


            <div class="agreement-buttons">
                <button id="agree-btn-1" class="agree-btn">I Agree</button>
                <button id="agree-btn-2" class="agree-btn">I Agree</button>
            </div>

        </div>

        <div class="visitor-counter">
            <span>Today's visitor: <span id="counter">0000</span></span>
        </div>
    </main>

    <script src="js/script.js"></script>
    <script>
        sessionStorage.setItem('entryTime', new Date().toISOString());

        document.getElementById('agree-btn-1').addEventListener('click', enterMuseum);
        document.getElementById('agree-btn-2').addEventListener('click', enterMuseum);

        function enterMuseum() {

            recordInteraction('consent_given');
            window.location.href = 'atrium.html';
        }

        setInterval(() => {
            const counter = document.getElementById('counter');
            let count = parseInt(counter.textContent);
            counter.textContent = String(count + 1).padStart(4, '0');
        }, 3000);

        const chars = "アイウカキクケコｱｲｳｴｵ012345789ABCDEFGHIJKLMNOPQRSTUVXYZ#$%&*+=-";

        const secretMessages = [
            "YOU ARE BEING WATCHED",
            "DATA LOGGED",
            "CONSENT RECORDED",
            "SYSTEM MONITORING YOU",
            "TRACKING BEHAVIOR",
            "ANALYSIS IN PROGRESS",
            "USER ID: UNKNOWN",
            "███ ACCESS GRANTED ███"
        ];

        const backLayer = document.getElementById("layer-back");
        const frontLayer = document.getElementById("layer-front");
        const secretMsg = document.getElementById("secretMsg");

        function createRain(layer, amount, speedMin, speedMax) {
            for (let i = 0; i < amount; i++) {
                const col = document.createElement("div");
                col.classList.add("matrix-column");

                let length = Math.random() * 20 + 10;
                let text = "";
                for (let j = 0; j < length; j++) {
                    text += chars[Math.floor(Math.random() * chars.length)] + "\n";
                }

                col.textContent = text;

                col.style.left = `${Math.random() * 100}vw`;
                const duration = Math.random() * (speedMax - speedMin) + speedMin;

                col.style.animation = `rain ${duration}s linear infinite`;
                col.dataset.speed = duration;

                layer.appendChild(col);
            }
        }

        createRain(backLayer, 60, 10, 15);
        createRain(frontLayer, 90, 6, 10);

        document.addEventListener("mousemove", e => {
            const x = e.clientX;
            const y = e.clientY;

            document.querySelectorAll(".matrix-column").forEach(col => {
                const rect = col.getBoundingClientRect();
                const dx = rect.left - x;
                const dy = rect.top - y;
                const dist = Math.sqrt(dx * dx + dy * dy);

                if (dist < 150) {
                    const angle = Math.atan2(dy, dx);
                    const tx = Math.cos(angle) * 80;
                    const ty = Math.sin(angle) * 80;
                    col.style.transform = `translate(${tx}px, ${ty}px)`;
                } else {
                    col.style.transform = "";
                }
            });
        });

        function flashSecretMessage() {
            const msg = secretMessages[Math.floor(Math.random() * secretMessages.length)];
            secretMsg.textContent = msg;
            secretMsg.style.opacity = 1;

            setTimeout(() => secretMsg.style.opacity = 0, 300);
        }

        setInterval(flashSecretMessage, 6000 + Math.random() * 4000);

        let clicks = 0;
        let startTime = Date.now();

        function updateColorBehavior() {
            const duration = (Date.now() - startTime) / 1000; // seconds

            let color = "#00ff41";  // default green

            if (clicks > 10) color = "#ff0000";     // heavy clicking → danger red
            else if (duration > 20) color = "#ffff00"; // long stay → yellow warning

            document.querySelectorAll(".matrix-column").forEach(col => {
                col.style.color = color;
                col.style.filter = `drop-shadow(0 0 6px ${color})`;
            });
        }

        setInterval(updateColorBehavior, 1000);

        document.addEventListener("click", e => {
            clicks++;
            for (let i = 0; i < 25; i++) {
                const p = document.createElement("div");
                p.classList.add("particle");
                p.textContent = chars[Math.floor(Math.random() * chars.length)];

                p.style.left = e.clientX + "px";
                p.style.top = e.clientY + "px";

                document.body.appendChild(p);

                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * 6 + 2;

                const vx = Math.cos(angle) * speed;
                const vy = Math.sin(angle) * speed;

                let opacity = 1;

                const anim = setInterval(() => {
                    const rect = p.getBoundingClientRect();
                    p.style.left = rect.left + vx + "px";
                    p.style.top = rect.top + vy + "px";

                    opacity -= 0.03;
                    p.style.opacity = opacity;

                    if (opacity <= 0) {
                        clearInterval(anim);
                        p.remove();
                    }
                }, 16);
            }
        });

    </script>

    <!--Footer-->
    <footer>
        <small><em>© This website was created as part of a student peoject. All content and design are copyright
                Haolei Ma, student, 2025</em></small>
    </footer>


</body>

</html>